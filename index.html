<!DOCTYPE html>
<html>
  <head>

  </head>

  <body>

    <div class="jumbotron text-center">
      <div class="container">
        <h3>Subnet Calcalator</h3>
      </div>
    </div>
    <div class="container">
      <div class="col-sm-2 form-col">
          <label class="control-label">Subnet</label>
      </div>
      <div class="col-sm-6 form-col">
        <select id="subnet">
          <option value="32">255.255.255.255 / 32</option>
          <option value="31">255.255.255.254 / 31</option>
          <option value="30">255.255.255.252 / 30</option>
          <option value="29">255.255.255.248 / 29</option>
          <option value="28">255.255.255.240 / 28</option>
          <option value="27">255.255.255.224 / 27</option>
          <option value="26">255.255.255.192 / 26</option>
          <option value="25">255.255.255.128 / 25</option>
          <option value="24">255.255.255.0 / 24</option>
          <option value="23">255.255.254.0 / 23</option>
          <option value="22">255.255.252.0 / 22</option>
          <option value="21">255.255.248.0 / 21</option>
          <option value="20">255.255.240.0 / 20</option>
          <option value="19">255.255.224.0 / 19</option>
          <option value="18">255.255.192.0 / 18</option>
          <option value="17">255.255.128.0 / 17</option>
          <option value="16">255.255.0.0 / 16</option>
          <option value="15">255.254.0.0 / 15</option>
          <option value="14">255.252.0.0 / 14</option>
          <option value="13">255.248.0.0 / 13</option>
          <option value="12">255.240.0.0 / 12</option>
          <option value="11">255.224.0.0 / 11</option>
          <option value="10">255.192.0.0 / 10</option>
          <option value="9">255.128.0.0 / 9</option>
          <option value="8">255.0.0.0 / 8</option>
          <option value="7">254.0.0.0 / 7</option>
          <option value="6">252.0.0.0 / 6</option>
          <option value="5">248.0.0.0 / 5</option>
          <option value="4">240.0.0.0 / 4</option>
          <option value="3">224.0.0.0 / 3</option>
          <option value="2">192.0.0.0 / 2</option>
          <option value="1">128.0.0.0 / 1</option>
        </select>
      </div>
    </div>
    <div class="container">
      <div class="col-sm-2 form-col">
          <label class="control-label">IP Address</label>
      </div>
      <div class="col-sm-6 form-col">
        <input id="ip" type="text" value="158.108.12.34">
      </div>
    </div>
    <div class="col-sm-2 form-col">
      <button class="btn btn-default btn-primary" type="submit" onclick="show()">Calculate</button>
    </div>

    <table id="baseTable"></table>

    <table id="possibleTable"></table>

  </body>

</html>

<script>
  var MAXBIT = 32

  var subnet = document.getElementById("subnet");
  var ip = document.getElementById("ip");
  var baseTable = document.getElementById("baseTable");
  var possibleTable = document.getElementById("possibleTable");

  function splitBinToIp(ip){
    blocks = []
    blocks[0] = ip.substring(0,8)
    blocks[1] = ip.substring(8,16)
    blocks[2] = ip.substring(16,24)
    blocks[3] = ip.substring(24,32)
    return blocks
  }

  function bitToDec(bitString) {
    return parseInt(bitString, 2).toString(10)
  }

  // function decToBit(string) {
  //   return parseInr
  // }

  function replaceStringAt(string, ch, index) {
    return string.substring(0, index) + ch + string.substring(index + 1)
  }

  // function splitIpToBin(ip){
  //   ip = ip.split(',')
  //   ip.
  // }

  function subnetMask() {
    var sub = 0xffffffff
    sub = sub.toString(2)
    for(var i=subnet.value; i<MAXBIT; i++){
      sub = replaceStringAt(sub, '0', i)
    }
    sub = splitBinToIp(sub)
    sub = bitToDec(sub[0]) + '.' + bitToDec(sub[1]) + '.' + bitToDec(sub[2]) + '.' + bitToDec(sub[3])
    return sub
  }

  function networkAddress(){
    ip
  }

  function subClass(){
    if(subnet.value <= 8){
      return '-'
    }
    else if(subnet.value <= 16){
      return 'A'
    }
    else if(subnet.value <= 24){
      return 'B'
    }
    else if(subnet.value <= 32){
      return 'C'
    }
  }

  function createPossibleTable() {
    headers = ["Network Address", "Usable Host Range", "Broadcast Address:"]
    data = [];
    possibleTable.innerHTML = ""
    var tr = document.createElement("tr");
    for (var i=0; i<headers.length; i++) {
     var txt = document.createTextNode(headers[i]);
     var th = document.createElement("th");
     th.appendChild(txt);
     tr.appendChild(th)
     possibleTable.appendChild(tr);
    }

    var tr = document.createElement("tr");
    for (var i=0; i<data.length; i++) {
     var txt = document.createTextNode(data[i]);
     var td = document.createElement("td");
     td.appendChild(txt);
     tr.appendChild(td)
     possibleTable.appendChild(tr);
    }
  }

  function createBaseTable() {
    headers = ["IP Address", "Network Address", "Usable Host IP Range", "Broadcast Address", "Total Number of Hosts", "Number of Usable Hosts", "Subnet Mask", "Wildcard Mask", "Binary Subnet Mask", "IP Class", "CIDR Notation", "IP Type", "Short", "Binary ID", "Integer ID", "Hex ID", "in-addr.arpa", "IPv4 Mapped Address", "6to4 Prefix"]
    data = [];
    data[0] = ip.value
    data[1] =
    data[6] = subnetMask()
    data[9] = subClass()
    data[10] = '/' + subnet.value
    baseTable.innerHTML = ""
    for (var i=0; i<headers.length; i++) {
      var tr = document.createElement("tr");
      var txt = document.createTextNode(headers[i]);
      var datum = document.createTextNode(data[i]);
      var th = document.createElement("th");
      var td = document.createElement("td");
      td.appendChild(datum)
      th.appendChild(txt)
      tr.appendChild(th)
      tr.appendChild(td)
      baseTable.appendChild(tr);
    }
  }

  function show() {
    createBaseTable()
    createPossibleTable()
  }

</script>
